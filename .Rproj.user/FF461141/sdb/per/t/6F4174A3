{
    "collab_server" : "",
    "contents" : "#\n# This is the server logic of a Shiny web application. You can run the \n# application by clicking 'Run App' above.\n#\n# Find out more about building applications with Shiny here:\n# \n#    http://shiny.rstudio.com/\n#\n\n## grepl(df,regex,column)\n\nact_df <- read.csv(\"./data/tourist_activity.csv\")\nrev_df <- read.csv(\"./data/revenue_usd.csv\")\n\n# Define server logic required to draw a histogram\nshinyServer(function(input, output) {\n  \n  \n  activity <- reactive({\n    act_df %>% filter(grepl(input$year,Periodo))\n    })\n  \n  output$boxPlots <- renderPlotly({\n    gg <- activity() %>%\n      ggplot(aes(x=Destino, y=Visitantes, fill=Destino))+geom_boxplot()\n    ggplotly(gg)\n    \n  })\n  \n  output$pctChart <- renderPlotly({\n    gg <- activity() %>%\n      ggplot(aes(x=Destino, y=Porcentaje.Ocupacion.promedio, color=Destino))+geom_point(position = \"jitter\")\n    ggplotly(gg)\n  })\n  \n  \n  avgVisitors <- reactive({\n    avgVisitors <-  activity() %>%\n      filter(grepl(input$year,Periodo)) %>% \n      group_by(Destino) %>%\n      summarise(LocalPct=100*mean(Nacional/Visitantes)\n                , ForeignPct = 100*mean(Internacional/Visitantes)) \n  })\n  \n  output$barPlots <- renderPlotly({\n    # avgVisitors <-  activity %>%\n    #   filter(grepl('2015',Periodo)) %>% \n    #   group_by(Destino) %>%\n    #   summarise(LocalPct=100*mean(Nacional/Visitantes)\n    #             , ForeignPct = 100*mean(Internacional/Visitantes)) \n    \n    gg <- avgVisitors() %>%\n      ggplot(aes(x=LocalPct, y=ForeignPct, color=Destino))+\n      geom_point()+geom_abline(intercept = 0,slope=1)+\n      xlim(0,100)+ylim(0,100)+xlab(\"Local Visitors\")+ylab(\"Foreign Visitors\")\n    ggplotly(gg)\n  })\n  \n  \n  output$revPlot <- renderPlotly({\n    gg <- rev_df %>% filter(!grepl(\"Total \",CIP), \n                      grepl(input$year,Periodo) ) %>% \n      ggplot(aes(x=Periodo,y=Millones.de.dolares, fill=CIP))+\n      geom_bar(stat = 'identity')+coord_flip()\n    ggplotly(gg)\n  })\n})\n",
    "created" : 1477727489678.000,
    "dirty" : false,
    "encoding" : "UTF-8",
    "folds" : "",
    "hash" : "3745186657",
    "id" : "6F4174A3",
    "lastKnownWriteTime" : 1477737025,
    "last_content_update" : 1477737025921,
    "path" : "~/Documents/Courses/CERGE-Building-Shiny-Apps/Lecture 3 - Shiny/tourism_dashboard/tourism_dashboard/server.R",
    "project_path" : "tourism_dashboard/server.R",
    "properties" : {
    },
    "relative_order" : 2,
    "source_on_save" : false,
    "source_window" : "",
    "type" : "r_source"
}